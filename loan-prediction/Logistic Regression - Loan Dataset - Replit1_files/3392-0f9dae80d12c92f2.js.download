!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="875cf11d-cd13-4bcc-abf1-e0a982e16f26",e._sentryDebugIdIdentifier="sentry-dbid-875cf11d-cd13-4bcc-abf1-e0a982e16f26")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"6fc18b5e"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3392],{32147:function(e,n,r){r.d(n,{FW:function(){return f},NH:function(){return m}});var t=r(41733),i=r(21262),o=r(71440),l=r(80428),u=r(41538),s=r(58995);function a(){var e=(0,i._)(["\n  fragment PublishReplData on Repl {\n    id\n    url\n    title\n    description\n    iconUrl\n    lastPublishedAt\n    publishedAs\n    imageUrl\n    isRenamed\n    templateInfo {\n      iconUrl\n    }\n    replViewSettings {\n      id\n      defaultView\n      replImage\n      replFile\n    }\n    tags {\n      id\n      isOfficial\n    }\n    currentUserPermissions {\n      containerWrite\n      publish\n      changeIconUrl\n    }\n    ...CrosisContextRepl\n    ...PublishedReplShareInfoReplData\n  }\n  ","\n  ","\n"]);return a=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment PublishCurrentUser on CurrentUser {\n    id\n    image\n    isTemplateDeveloper: hasRole(role: TEMPLATE_DEVELOPER)\n    ...CrosisContextCurrentUser\n  }\n  ","\n"]);return c=function(){return e},e}function d(){var e=(0,i._)(["\n  query PublishCurrentUser {\n    currentUser {\n      id\n      ...PublishCurrentUser\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var p={},f=(0,o.Ps)(a(),l.C,u.B),h=(0,o.Ps)(c(),l.D),v=(0,o.Ps)(d(),h);function m(e){var n=(0,t._)({},p,e);return s.a(v,n)}},41538:function(e,n,r){r.d(n,{B:function(){return o}});var t=r(21262);function i(){var e=(0,t._)(["\n  fragment PublishedReplShareInfoReplData on Repl {\n    id\n    url\n    publishedAs\n    title\n  }\n"]);return i=function(){return e},e}var o=(0,r(71440).Ps)(i())},25061:function(e,n,r){r.d(n,{Z:function(){return x}});var t=r(27387),i=r(96583),o=r(74985),l=r(75246),u=r(74833),s=r(56596),a=r(93918),c=r(29287);r(50959);var d=(0,a.X)({styles0:[c.l0.colWithGap(8)],styles1:[c.l0.colWithGap(8)],styles2:[c.l0.colWithGap(8)]}),p=(0,a.X)({content:[c.l0.p(8),c.l0.colWithGap(16)],section:[c.l0.colWithGap(8)]});function f(e){var n=e.header;return(0,o.tZ)(l.Q,{headerContent:n,children:(0,o.BX)(s.G,{css:p.content,children:[(0,o.BX)(s.G,{css:p.section,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Bold Text"}),(0,o.tZ)(u.xv,{color:"dimmer",multiline:!1,children:"**bold**"})]}),(0,o.BX)(s.G,{css:p.section,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Italic Text"}),(0,o.tZ)(u.xv,{color:"dimmer",multiline:!1,children:"__italic__"})]}),(0,o.BX)(s.G,{css:p.section,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Links"}),(0,o.tZ)(u.xv,{color:"dimmer",multiline:!1,children:"[Link Name](https://yourlink.com)"})]}),(0,o.BX)(s.G,{css:p.section,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Images"}),(0,o.tZ)(u.xv,{color:"dimmer",multiline:!1,children:"![Image alt text](https://linktoyourimage.com)"})]}),(0,o.BX)(s.G,{css:p.section,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Header Text"}),(0,o.tZ)(u.xv,{color:"dimmer",multiline:!1,children:"# Header"})]}),(0,o.BX)(s.G,{css:d.styles0,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Code Blocks"}),(0,o.BX)(u.xv,{color:"dimmer",multiline:!1,children:["```",(0,o.tZ)("br",{}),"this is for large, multiline code blocks",(0,o.tZ)("br",{}),"```"]})]}),(0,o.BX)(s.G,{css:d.styles1,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Inline Code"}),(0,o.tZ)(u.xv,{color:"dimmer",multiline:!1,children:"`this is for code in the middle of sentences`"})]}),(0,o.BX)(s.G,{css:d.styles2,children:[(0,o.tZ)(u.xv,{multiline:!1,children:"Horizontal Rules"}),(0,o.tZ)(u.xv,{color:"dimmer",multiline:!1,children:"***"})]})]})})}var h=r(72310),v=r(59868),m=r(1498),g=r(18836),y=r(37951),b=r(74883),R=r(20573),w=r(10981),_=r(75582),C=r(69273),Z=s.K.form;function E(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>100?{message:"The title should not be longer than ".concat(100," characters.")}:void 0}function P(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>5e3?{message:"The description should not be longer than ".concat(5e3," characters.")}:void 0}function x(e){var n,r,l,a=e.repl,d=e.source,p=e.onDone,x=(0,w.U)(),T=x("titleIdInput"),F=x("descriptionIdInput"),I=(0,h.Y)("",E),U=(0,h.Y)("",P),G=(0,C.O)();return(0,o.BX)(Z,{onSubmit:(n=(0,t._)(function(e){return(0,i.Jh)(this,function(n){switch(n.label){case 0:if(e.preventDefault(),I.validate()||U.validate())return[2];return[4,G.publish({input:{replId:a.id,title:I.value,body:U.value}})];case 1:return n.sent().error||((0,v.j)(v.U3.UPDATE_SHARED,{source:d,replType:a.publishedAs===_.O2.Template?"template_repl":"regular_repl"}),p()),[2]}})}),function(e){return n.apply(this,arguments)}),css:[c.l0.colWithGap(16)],children:[(0,o.tZ)(u.h4,{level:1,variant:"headerDefault",children:"Add an update"}),(0,o.BX)(u.xv,{multiline:!1,children:["Explain what has changed about this"," ",a.publishedAs===_.O2.Template?"Template":"Repl","."]}),(0,o.BX)(s.G,{css:c.l0.colWithGap(8),children:[(0,o.BX)(s.G,{css:c.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:c.l0.color.foregroundDimmer,htmlFor:T,children:"Title"}),(0,o.tZ)(g.II,{id:T,onChange:function(e){I.setValue(e.target.value)},disabled:G.loading,placeholder:"Give your post a title"})]}),I.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(R.Z,{}),text:null===(r=I.error)||void 0===r?void 0:r.message,colorway:"negative"}):null]}),(0,o.BX)(s.G,{css:c.l0.colWithGap(8),children:[(0,o.BX)(s.G,{css:c.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:c.l0.color.foregroundDimmer,htmlFor:F,children:"Description"}),(0,o.tZ)(g.B,{id:F,onChange:function(e){U.setValue(e.target.value)},css:[c.l0.width("100%"),{minHeight:c.TV.space128,maxHeight:c.TV.space256,resize:"vertical",lineHeight:c.TV.lineHeightDefault}],disabled:G.loading,placeholder:"Write something about this post"})]}),U.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(R.Z,{}),text:null===(l=U.error)||void 0===l?void 0:l.message,colorway:"negative"}):null]}),(0,o.tZ)(f,{header:"Style your description with Markdown"}),G.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(R.Z,{}),colorway:"negative",text:G.error}):null,(0,o.tZ)(m.zx,{text:G.loading?"Sharing update...":"Share update",type:"submit",colorway:"primary",disabled:!!(G.loading||I.error||U.error),css:{alignSelf:"end"},iconLeft:(0,o.tZ)(b.Z,{})})]})}},69273:function(e,n,r){r.d(n,{O:function(){return v}});var t=r(27387),i=r(66626),o=r(96583),l=r(41733),u=r(21262),s=r(71440),a=r(32147),c=r(99165);function d(){var e=(0,u._)(["\n  mutation PublishReplCreatePost($input: CreateReplPost2Input!) {\n    createReplPost2(input: $input) {\n      ... on Post {\n        id\n        repl {\n          id\n          ...PublishReplData\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var p={},f=(0,s.Ps)(d(),a.FW);function h(e){var n,r,t,i,o,l,u;return e.error?e.error.message||"Something went wrong publishing your Repl":(null===(r=e.data)||void 0===r?void 0:null===(n=r.createReplPost2)||void 0===n?void 0:n.__typename)==="NotFoundError"||(null===(i=e.data)||void 0===i?void 0:null===(t=i.createReplPost2)||void 0===t?void 0:t.__typename)==="UnauthorizedError"||(null===(l=e.data)||void 0===l?void 0:null===(o=l.createReplPost2)||void 0===o?void 0:o.__typename)==="UserError"?e.data.createReplPost2.message:(null===(u=e.data)||void 0===u?void 0:u.createReplPost2)&&"Post"!==e.data.createReplPost2.__typename?"Something went wrong publishing your Repl":void 0}function v(){var e,n,r=(0,i._)((e=(0,l._)({},p,void 0),c.D(f,e)),2),u=r[0],s=r[1];return{publish:(n=(0,t._)(function(e){var n,r;return(0,o.Jh)(this,function(t){switch(t.label){case 0:if(n=e.input,s.loading)return[2,{data:null,error:null}];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,u({variables:{input:n}})];case 2:return[2,{data:(r=t.sent()).data,error:h(r)}];case 3:return t.sent(),[2,{data:null,error:"Something went wrong publishing your Repl"}];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),data:s.data,loading:s.loading,error:h(s)}}},23855:function(e,n,r){r.d(n,{sI:function(){return l}});var t=r(21262);function i(){var e=(0,t._)(["\n  fragment ReplViewerOutputOverlayRepl on Repl {\n    id\n    title\n    imageUrl\n    lastPublishedAt\n    currentUserPermissions {\n      changeImageUrl\n    }\n  }\n"]);return i=function(){return e},e}function o(){var e=(0,t._)(["\n  mutation ReplViewerOutputOverlayUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        imageUrl\n      }\n    }\n  }\n"]);return o=function(){return e},e}var l=(0,r(71440).Ps)(i());o()},5693:function(e,n,r){r.d(n,{Z:function(){return _}});var t=r(66626),i=r(74985),o=r(55534),l=r(59868),u=r(1498),s=r(74833),a=r(56596),c=r(98859),d=r(29287),p=r(75582),f=r(41733),h=r(21262),v=r(71440),m=r(73931),g=r(99165);function y(){var e=(0,h._)(["\n  mutation UnpublishReplUnpublish($input: UnpublishReplFromCommunityInput!) {\n    unpublishReplFromCommunity(input: $input) {\n      ... on Repl {\n        id\n        ...ReplViewReplActionsPermissions\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n  ","\n"]);return y=function(){return e},e}var b={},R=(0,v.Ps)(y(),m.jN),w=a.K.form;function _(e){var n,r,h=e.repl,v=e.source,m=e.onDone,y=(0,o.Z)(),_=y.showConfirm,C=y.showError,Z=(0,t._)((n={variables:{input:{replId:h.id}},onCompleted:function(e){if("Repl"===e.unpublishReplFromCommunity.__typename){var n=e.unpublishReplFromCommunity.likeCount;(0,l.j)(l.U3.REPL_UNPUBLISHED,{source:v,numLikes:n,replType:h.publishedAs===p.O2.Template?"template_repl":"regular_repl"}),_("Repl removed from the community.")}else"NotFoundError"===e.unpublishReplFromCommunity.__typename||"UnauthorizedError"===e.unpublishReplFromCommunity.__typename?C(e.unpublishReplFromCommunity.message):C("An unexpected error occurred.");m()},onError:function(){C("Something went wrong. Please try again.")},update:function(e){e.modify({id:e.identify({__typename:"Repl",id:h.id}),fields:{comments:function(e,n){return n.DELETE},tags:function(e,n){return n.DELETE}}})}},r=(0,f._)({},b,n),g.D(R,r)),2),E=Z[0],P=Z[1].loading;return(0,i.BX)(a.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(s.xv,{variant:"subheadBig",children:"Unpublish this Repl from the Community"}),(0,i.BX)(w,{onSubmit:function(e){e.preventDefault(),E()},css:[d.l0.colWithGap(32)],children:[(0,i.tZ)(s.xv,{children:"Unpublishing a Repl will remove it from the Community. This action will delete all associated posts and tags. The Repl and all its comments will still be visible in your profile, but will not be shown in the Community or Trending views anymore. You can always re-publish the Repl again later."}),(0,i.BX)(a.G,{css:[d.l0.rowWithGap(8),d.l0.justify.end],children:[(0,i.tZ)(a.G,{children:(0,i.tZ)(u.zx,{type:"button",text:"Cancel",onClick:function(){return m()}})}),(0,i.tZ)(a.G,{children:(0,i.tZ)(u.zx,{disabled:P,colorway:"negative",text:P?"Unpublishing...":"Yes, unpublish this Repl",type:"submit",iconLeft:(0,i.tZ)(c.Z,{})})})]})]})]})}},30173:function(e,n,r){r.d(n,{S:function(){return l}});var t=r(7444),i=r(91087),o=r(50959);function l(){var e=(0,i.mC)(),n=(0,t.Z)(e);return(0,o.useCallback)(function(){var e,r;return!Number.isFinite(r=parseInt(null==(e=n.current)?void 0:e.variation("flag-container-retry-minimum-ms",0),10))||r<0?0:r},[n])}},33829:function(e,n,r){r.d(n,{Z:function(){return C}});var t={};r.r(t),r.d(t,{checkAndTrack:function(){return R},ensureTrackedFile:function(){return g},storeOp:function(){return y}});var i=r(59868),o=r(27387),l=r(66626),u=r(96583),s=r(11516),a=r(41733),c={};function d(e,n,r){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.info("ot client dataloss",(0,a._)({case:n,startTime:r.startTime,opsSinceFlush:r.opsSinceFlush,whileReconnecting:r.whileReconnecting,replid:r.replId,filePath:r.filePath},t))}var p=r(70090),f={replsList:function(){return"dataLossRepls"},replFiles:function(e){return"dataLossReplFiles".concat(e)},latestOp:function(e,n){return"dataLossLatestOp--".concat(e,"--").concat(n)},latestFlushedOp:function(e,n){return"dataLossLatestFlushed--".concat(e,"--").concat(n)},latestOwnOp:function(e,n){return"dataLosslatestOwnOp--".concat(e,"--").concat(n)},opsSinceFlush:function(e,n){return"dataLossOpsSinceFlush--".concat(e,"--").concat(n)}};function h(){var e=s.Z.get(f.replsList(),"array");return e||(e=[],s.Z.set(f.replsList(),e)),e}function v(e){var n=s.Z.get(f.replFiles(e),"array");return n||(n=[],s.Z.set(f.replFiles(e),n)),n}function m(e){var n=v(e),r=!0,t=!1,i=void 0;try{for(var o,l=n[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var u=o.value;"string"==typeof u&&function(e,n){s.Z.remove(f.latestOp(e,n)),s.Z.remove(f.latestFlushedOp(e,n)),s.Z.remove(f.latestOwnOp(e,n));var r=v(e).filter(function(e){return e!==n});s.Z.set(f.replFiles(e),r)}(e,u)}}catch(e){t=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(t)throw i}}s.Z.remove(f.replFiles(e));var a=h().filter(function(n){return n!==e});s.Z.set(f.replsList(),a)}function g(e){var n,r=e.replId,t=e.filePath;(n=h()).includes(r)||(n.length>20?(m(n[0]),n[0]=r):n.push(r),s.Z.set(f.replsList(),n));var i=v(r);i.includes(t)||(i.length>20?(m(i[0]),i[0]=t):i.push(t),s.Z.set(f.replFiles(r),i))}function y(e){var n=e.filePath,r=e.replId,t=e.opType,i=e.op;!function(e){var n=e.filePath,r=e.replId,t=e.opType,i=e.logger,o=e.isReconnecting,l=d.bind(null,i),u="".concat(r,"--").concat(n);c[u]||(c[u]={replId:r,filePath:n,timer:null,startTime:null,whileReconnecting:0,opsSinceFlush:0});var s=c[u];if("latestFlushedOp"===t){delete c[u];var a=s.startTime;if(a){var p=Date.now()-a;p>6e4&&l("flush_delay_received",s,{elapsed:p})}var f=s.timer;f&&(clearTimeout(f),s.timer=null)}else{s.opsSinceFlush+=1,o&&(s.whileReconnecting+=1);var h,v=null!==(h=s.startTime)&&void 0!==h?h:Date.now();s.startTime=v,s.timer||(s.timer=setTimeout(function(){l("flush_delay_timeout",s)},6e4)),150===s.opsSinceFlush?l("flush_delay_small",s):1e3===s.opsSinceFlush&&l("flush_delay_large",s)}}({filePath:n,replId:r,opType:t,logger:e.logger,isReconnecting:e.isReconnecting}),s.Z.set(f[t](r,n),i)}var b={};function R(e){return w.apply(this,arguments)}function w(){return(w=(0,o._)(function(e){var n,r,t,i,a,c,d,h;return(0,u.Jh)(this,function(v){var m;return n=e.filePath,r=e.replId,t=e.serverVersion,i=e.serverContent,a=e.fetchOps,c=e.logger,b[n+r]||(b[n+r]=!0,d=function(e,n){var r={latestOp:null,latestFlushedOp:null,latestOwnOp:null},t=Object.keys(r),i=!0,o=!1,l=void 0;try{for(var u,a=t[Symbol.iterator]();!(i=(u=a.next()).done);i=!0){var c=u.value,d=s.Z.get(f[c](e,n),"object");d&&d&&"object"==typeof d&&"number"==typeof d.crc32&&"number"==typeof d.version&&(r[c]=d)}}catch(e){o=!0,l=e}finally{try{i||null==a.return||a.return()}finally{if(o)throw l}}return r}(r,n),h=p.str(i)>>>0,Object.keys(d).forEach((m=(0,o._)(function(e){var n,r,i;return(0,u.Jh)(this,function(o){switch(o.label){case 0:if(!(n=d[e]))return[2];if(t<n.version)return c.info("ot client dataloss",{opType:e,case:"server_forgot"}),[2];if(t===n.version)return h!==n.crc32&&c.info("ot client dataloss",{opType:e,case:"crc32_mismatch"}),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a(n.version,n.version)];case 2:return r=l._.apply(void 0,[o.sent(),1])[0],[3,4];case 3:return i=o.sent(),c.info("ot client dataloss",{opType:e,case:"error_fetching_op",originalError:String(i)}),[2];case 4:if(!r)return c.info("ot client dataloss",{opType:e,case:"op_not_found"}),[2];return r.crc32!==n.crc32&&c.info("ot client dataloss",{opType:e,case:"crc32_mismatch"}),[2]}})}),function(e){return m.apply(this,arguments)}))),[2]})})).apply(this,arguments)}var _=r(48170);function C(e){var n=e.container,r=e.channelRequestPriority;return(0,_.Z)({container:n,dataloss:t,track:i.j,channelRequestPriority:r})}},44161:function(e,n,r){r.d(n,{Z:function(){return u}});var t=r(47611),i=r.n(t),o=r(66005),l=r(49500);function u(e){var n=e.throwBsod,r=e.tags,t=e.extras,u=e.origin,s=e.onNonBsodUnrecoverableError,a=void 0===s?function(){}:s;return function(e){var s=(0,o.ZP)(e);if(s===o.Gs.NotFound){i().push("/home","~/");return}if(s===o.Gs.LanguageTokenDenied){window.location.reload();return}if(s){a(s);return}l.error(e),n({error:e,tags:r,extras:t,origin:u})}}},63009:function(e,n,r){r.d(n,{I7:function(){return g},Id:function(){return m},ic:function(){return R},jT:function(){return v},qg:function(){return b},uV:function(){return y}});var t=r(41733),i=r(30509),o=r(1323),l=r(64461),u=r(19713),s=r(80703),a=r(65381),c=r(50959),d=(0,u.cn)(null),p=(0,u.cn)(null,function(e,n,r){var l=r.error,u=r.tags,s=r.extras,a=r.origin,c=(0,i._)((0,t._)({},u),{origin:a});"statusCode"in l?c.statusCode=l.statusCode:"status"in l&&(c.statusCode=l.status),e(d)||n(d,{eventId:(0,o.I)(l,{tags:c,extras:s}),error:l,sentry:{tags:c,extras:s},origin:a})}),f=(0,u.cn)(null,function(e,n){n(d,null)}),h=(0,u.cn)(new Map);function v(){return(0,a.lV)((0,c.useCallback)(function(e,n,r){var t=r.filePath;return e(h).get(t)},[]))}function m(){return(0,a.lV)((0,c.useCallback)(function(e,n,r){var t=r.filePath,i=r.version;n(h,function(e){return(0,l.Uy)(e,function(e){e.set(t,i)})})},[]))}function g(){return(0,a.lV)((0,c.useCallback)(function(e,n,r){var t=r.filePath;n(h,function(e){return(0,l.Uy)(e,function(e){e.delete(t)})})},[]))}function y(){return(0,s.b9)(p)}function b(){return[(0,s.Dv)(d),y()]}function R(){return(0,s.b9)(f)}},2148:function(e,n,r){r.d(n,{Z:function(){return m},l:function(){return v}});var t=r(27387),i=r(63257),o=r(96583),l=r(83493),u=r(59808),s=r(30084),a=r(39756),c=r(25202),d=r(30671),p=r(60715),f=r(91620).lW,h=r(34523),v=".replit";function m(e){var n,r,m,g,y=e.container,b=e.fs,R=e.channelRequestPriority,w=e.ctx,_=(0,l.ZP)();_.setMaxListeners(50);var C=null,Z=null,E=null;function P(){return x.apply(this,arguments)}function x(){return(x=(0,t._)(function(){return(0,o.Jh)(this,function(e){return C&&"open"===C.status?[2,C]:[2,new Promise(function(e){_.once(u.zW.CHANNEL_OPENED,function(n){e(n)})})]})})).apply(this,arguments)}(function(){F.apply(this,arguments)})(),y.openChannel({service:"dotreplit",priority:R},function(e){var n=e.channel;return C=n,_.emit(u.zW.CHANNEL_OPENED,n),function(){C=null}});var T=!1;function F(){return(F=(0,t._)(function(){return(0,o.Jh)(this,function(e){return b.watchDir(a.Ql,{onChange:function(e){if(!e.some(function(e){return e.filename===v&&e.type===s.Tv.File})){(null==Z?void 0:Z.error)!==u.Yt.NotFound&&(Z={error:u.Yt.NotFound,errorMessage:"",config:null},_.emit(u.zW.CHANGE,Z));return}T||(T=!0,b.watchFile(v,{onChange:function(){Z=null,D.getConfig({bypassCache:!0}).then(function(e){_.emit(u.zW.CHANGE,e)})},onMoveOrDelete:function(){T=!1},onError:function(e,n){Z=null,T=!1,e.code||y.unrecoverableError(e,n)}}))},onError:function(e,n){y.unrecoverableError(e,n)}}),[2]})})).apply(this,arguments)}function I(){return(I=(0,t._)(function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:return Z=null,E||(E=function(){return U.apply(this,arguments)}()),[4,E];case 1:return Z=e.sent(),E=null,[2,Z]}})})).apply(this,arguments)}function U(){return(U=(0,t._)(function(){return(0,o.Jh)(this,function(e){var n;return[2,(0,d.DW)(w,"dotreplit.getConfigFromServer",(n=(0,t._)(function(e,n){var r,t,i,l;return(0,o.Jh)(this,function(o){switch(o.label){case 0:var s,a,c;return null==n||n.setAttributes((s={},(null==(a=y.getConnectionMetadata())?void 0:a.token)&&(s.tokenCluster=function(e){var n=e.split(".");if(4!==n.length)throw Error("Invalid token: should have exactly 4 parts: "+e);for(var r=n[2].replace(/-/g,"+").replace(/_/g,"/");r.length%4;)r+="=";var t=window.atob(r);if(t.length<64)throw Error("Invalid token: signed part is too short: "+t.length);var i=t.substring(0,t.length-64);return p.api.token.ReplToken.decode(f.from(i,"base64"))}(a.token).cluster),c=!!window.performance.getEntriesByName(h.Iy.pageNavStart,"mark").length,s.ssr=c,s)),[4,P()];case 1:if("closed"===(t=o.sent()).status)return[2,{error:u.Yt.Disconnected,errorMessage:"channel closed",config:null}];return[4,t.request({dotReplitGetRequest:{},traceInfo:e?(0,d.Rg)(e):void 0})];case 2:if((i=o.sent()).channelClosed)return[2,{error:u.Yt.Disconnected,errorMessage:"channel closed",config:null}];if(i.error){if(i.error.includes("unable to decode"))return[2,{error:u.Yt.ParseError,errorMessage:i.error,config:null}];if(i.error.includes("no such file"))return[2,{error:u.Yt.NotFound,errorMessage:i.error,config:null}];return[2,{error:u.Yt.Unknown,errorMessage:i.error,config:null}]}if(!(l=null===(r=i.dotReplitGetResponse)||void 0===r?void 0:r.dotReplit))return y.unrecoverableError(Error("Dotreplit responded with no error and no config")),[2,{error:u.Yt.Unknown,errorMessage:"Expected dotReplitGetResponse to include dotReplit",config:null}];return[2,{error:null,errorMessage:null,config:l}]}})}),function(e,r){return n.apply(this,arguments)}))]})})).apply(this,arguments)}var G=(n=(0,t._)(function(e){var n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,b.stat(v)];case 1:if(r.sent().exists)return[3,3];return[4,b.writeFile(v,"")];case 2:r.sent(),r.label=3;case 3:return[4,P()];case 4:return[4,r.sent().request({dotReplitUpdateRequest:{ops:e}})];case 5:if((n=r.sent()).channelClosed)return[2,{errorMessage:"Channel closed.",error:u.au.ChannelClosed,response:null}];if(n.error){if(n.error.includes("could not parse json")||n.error.includes("is not json")||n.error.includes("parsing value field")||n.error.includes("missing field"))return[2,{errorMessage:n.error,error:u.au.JSONParseError,response:null}];if(n.error.includes("could not read file"))return[2,{errorMessage:n.error,error:u.au.NotFound,response:null}];if(n.error.includes("could not parse toml"))return[2,{errorMessage:n.error,error:u.au.TOMLParseError,response:null}];if(n.error.includes("unknown variant"))return[2,{errorMessage:n.error,error:u.au.OpType,response:null}];if(n.error.includes("could not write to file"))return[2,{errorMessage:n.error,error:u.au.CouldNotWrite,response:null}];if(n.error.includes("could not read line"))return[2,{errorMessage:n.error,error:u.au.ReadLine,response:null}];return[2,{errorMessage:n.error,error:u.au.Unknown,response:null}]}if(!n.dotReplitUpdateResponse)throw Error("Expected .replit to be updated");return[2,{response:n.dotReplitUpdateResponse,error:null,errorMessage:null}]}})}),function(e){return n.apply(this,arguments)}),D={watch:function(e){var n=!1,r=!1,t=function(){for(var n=arguments.length,t=Array(n),o=0;o<n;o++)t[o]=arguments[o];r=!0,e.apply(void 0,(0,i._)(t))};return _.on(u.zW.CHANGE,t),D.getConfig().then(function(e){n||r||t(e)}),function(){n=!0,_.removeListener(u.zW.CHANGE,t)}},getConfig:function(e){return(0,t._)(function(){return(0,o.Jh)(this,function(n){return(null==e?void 0:e.bypassCache)||!Z?[2,function(){return I.apply(this,arguments)}()]:[2,Z]})})()},getRunConfig:function(){return(0,t._)(function(){var e,n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,P()];case 1:return[4,r.sent().request({runConfigGetRequest:{}})];case 2:if((e=r.sent()).channelClosed)return[2,this.getRunConfig()];if(!e.runConfigGetResponse)throw null!==(n=e.error)&&void 0!==n?n:Error("expected run config");return[2,e.runConfigGetResponse]}})}).apply(this)},updateDotReplit:(r=[],m=400,g=(0,c.Z)((0,t._)(function(){var e;return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,G(r)];case 1:return e=n.sent(),r=[],[2,e]}})}),{wait:m}),function(e,n){n&&(m=n);var t=!0,i=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(t=(l=u.next()).done);t=!0)!function(){var e=l.value,n=r.findIndex(function(n){return n.path===e.path});-1!==n?r[n]=e:r.push(e)}()}catch(e){i=!0,o=e}finally{try{t||null==u.return||u.return()}finally{if(i)throw o}}return g()})};return D}}}]);
//# sourceMappingURL=3392-0f9dae80d12c92f2.js.map